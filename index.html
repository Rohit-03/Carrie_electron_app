<!DOCTYPE html>
<html>
<head>
    <title>Notion-like App</title>
    
    <!-- Add React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- External CSS file -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="sidebar">
        <!-- User Profile -->
        <div class="profile">
            <div class="avatar">RS</div>
            <div class="profile-info">
                <div class="profile-name">Rohit Shetty</div>
                <div class="profile-status">Online</div>
            </div>
        </div>
        <div class="sidebar-divider"></div>
        <!-- Central Hub -->
        <div class="sidebar-section">
            <div class="nav-item active" id="home-tab">
                <span class="sidebar-icon" aria-label="Home">
                  <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M3 12L12 3l9 9"/><path d="M9 21V9h6v12"/></svg>
                </span>
                Home
            </div>
            <div class="nav-item" id="tools-tab">
                <span class="sidebar-icon" aria-label="Tools">
                  <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06A1.65 1.65 0 0 0 15 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 8.6 15a1.65 1.65 0 0 0-1.82-.33l-.06-.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 15.4 9a1.65 1.65 0 0 0 1.82.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 15z"/></svg>
                </span>
                Tools
            </div>
        </div>
        <div class="sidebar-divider"></div>
        <!-- Projects -->
        <div class="sidebar-section">
            <div class="section-label">PROJECTS</div>
            <div class="project-list">
                <div class="project-item">
                    <span class="project-icon">üìÅ</span>
                    Tesla Earnings Project
                </div>
            </div>
        </div>
    </div>
    <div class="main-content">
        <div class="page-content" id="main-content-home">
            <div class="notion-home">
                <div class="notion-greeting">
                    <img src="cursor.png" alt="User" class="notion-greeting-icon" />
                    <div class="notion-greeting-text">Welcome to your workspace</div>
                </div>
                <div class="notion-searchbar-wrap">
                    <div class="notion-searchbar-box">
                        <input class="notion-searchbar-input" type="text" placeholder="Ask or find anything from your workspace..." />
                        <div class="notion-searchbar-bottom">
                            <div style="flex:1"></div>
                            <div class="notion-searchbar-icons">
                                <span class="notion-searchbar-icon">üìé</span>
                                <span class="notion-searchbar-icon">@</span>
                                <span class="notion-searchbar-arrow">‚Üë</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="notion-todo-section">
                    <div class="notion-todo-title">To do</div>
                    <div class="notion-todo-list">
                        <div class="notion-todo-card">
                            <div class="notion-todo-card-new">new</div>
                            <div class="notion-todo-card-title">Slide Updates - Manager Jeff</div>
                            <div class="notion-todo-card-desc">Refactor slides on Tesla project</div>
                            <button class="todo-start-btn" onclick="document.querySelector('.project-item').click()">Start</button>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
        <div class="page-content" id="main-content-tools" style="display:none;">
            <div class="notion-section">
                <div class="notion-section-title">Tools <span style="background: #f3f3f3; color: #888; font-size: 13px; font-weight: 600; border-radius: 8px; padding: 2px 8px; margin-left: 4px;">BETA</span></div>
                <div class="notion-section-desc">Connect your favorite tools so this app can access their information, based on what you're authorized to view.</div>
                <div class="notion-tool-grid">
                    <div class="tool-card" data-tool="PowerPoint">
                        <div class="tool-icon" style="background:#f3f3f3;"><img src="https://img.icons8.com/color/48/000000/microsoft-powerpoint-2019--v1.png" width="36" height="36"/></div>
                        <div class="tool-name">PowerPoint</div>
                        <button class="connect-btn">Connect</button>
                    </div>
                    <div class="tool-card" data-tool="Slack">
                        <div class="tool-icon" style="background:#f3f3f3;"><img src="https://img.icons8.com/color/48/000000/slack-new.png" width="36" height="36"/></div>
                        <div class="tool-name">Slack</div>
                        <button class="connect-btn">Connect</button>
                    </div>
                    <div class="tool-card" data-tool="Gmail">
                        <div class="tool-icon" style="background:#f3f3f3;"><img src="https://img.icons8.com/color/48/000000/gmail-new.png" width="36" height="36"/></div>
                        <div class="tool-name">Gmail</div>
                        <button class="connect-btn">Connect</button>
                    </div>
                    <div class="tool-card" data-tool="Zoom">
                        <div class="tool-icon" style="background:#f3f3f3;"><img src="https://img.icons8.com/color/48/000000/zoom.png" width="36" height="36"/></div>
                        <div class="tool-name">Zoom</div>
                        <button class="connect-btn">Connect</button>
                    </div>
                    <div class="tool-card add-tool">
                        <span style="font-size: 2.2rem; color: #b3b3b1; margin: 0 auto;">+</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="page-content" id="main-content-tesla" style="display:none;">
            <div id="tesla-react-container"></div>
        </div>
    </div>

    <!-- React Components -->
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Tesla Chat Component
        function TeslaChat() {
            const [isInitialLoading, setIsInitialLoading] = useState(true);
            const [loadingText, setLoadingText] = useState('');
            const [showProjectUpdatePopup, setShowProjectUpdatePopup] = useState(false);
            const [showMeetingNotesModal, setShowMeetingNotesModal] = useState(false);
            const [showActionPrompt, setShowActionPrompt] = useState(false);
            const [messages, setMessages] = useState([]);
            const [inputText, setInputText] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [showTasks, setShowTasks] = useState(false);
            const [completedTasks, setCompletedTasks] = useState(new Set());
            const [emailStep, setEmailStep] = useState('draft'); // draft, sending, sent, received
            
            // View toggle state
            const [currentView, setCurrentView] = useState('chat'); // 'chat' or 'workspace'
            
            // Animation states
            const [typedGreeting, setTypedGreeting] = useState('');
            const [showUserIcon, setShowUserIcon] = useState(false);
            const [showMeetingCard, setShowMeetingCard] = useState(false);
            const [showTasksTitle, setShowTasksTitle] = useState(false);
            const [visibleTasks, setVisibleTasks] = useState([]);
            const [showStartButton, setShowStartButton] = useState(false);
            
            const messagesEndRef = useRef(null);
            const inputRef = useRef(null);

            const fullGreeting = "Hey Rohit, looks like your meeting with Manager Jeff went well!";
            const greetingWords = fullGreeting.split(' ');

            // Typing animation effect - word by word
            useEffect(() => {
                if (showProjectUpdatePopup) {
                    // Show user icon first
                    if (!showUserIcon) {
                        setTimeout(() => setShowUserIcon(true), 200);
                        return;
                    }
                    
                    // Only start typing after icon is visible
                    if (showUserIcon && typedGreeting !== fullGreeting) {
                        const currentWordCount = typedGreeting.split(' ').length;
                        if (currentWordCount <= greetingWords.length) {
                            const timer = setTimeout(() => {
                                const nextWords = greetingWords.slice(0, currentWordCount).join(' ');
                                if (nextWords !== typedGreeting) {
                                    setTypedGreeting(nextWords);
                                } else if (currentWordCount < greetingWords.length) {
                                    setTypedGreeting(greetingWords.slice(0, currentWordCount + 1).join(' '));
                                }
                            }, currentWordCount === 0 ? 800 : 80); // Longer delay before first word
                            return () => clearTimeout(timer);
                        }
                    }
                }
            }, [showProjectUpdatePopup, typedGreeting, greetingWords, showUserIcon]);

            // Staggered animations after typing is complete
            useEffect(() => {
                if (typedGreeting === fullGreeting) {
                    // Show meeting card after greeting is complete (longer pause)
                    setTimeout(() => setShowMeetingCard(true), 500);
                    
                    // Show tasks title
                    setTimeout(() => setShowTasksTitle(true), 1700);
                    
                    // Show tasks one by one
                    setTimeout(() => {
                        tasks.forEach((task, index) => {
                            setTimeout(() => {
                                setVisibleTasks(prev => [...prev, task.id]);
                            }, index * 200);
                        });
                    }, 2200);
                    
                    // Show start button last
                    setTimeout(() => setShowStartButton(true), 2200 + (tasks.length * 200) + 300);
                }
            }, [typedGreeting, fullGreeting]);

            // Loading sequence
            useEffect(() => {
                const loadingSequence = [
                    { text: "Analyzing your latest Zoom meeting", duration: 200 },
                    { text: "Processing conversation with your manager", duration: 200 },
                    { text: "Extracting action items and deadlines", duration: 200 },
                    { text: "Prioritizing tasks based on urgency", duration: 200 },
                    { text: "Preparing your personalized task list", duration: 150 }
                ];

                let currentStep = 0;
                
                const runStep = () => {
                    if (currentStep < loadingSequence.length) {
                        setLoadingText(loadingSequence[currentStep].text);
                        setTimeout(() => {
                            currentStep++;
                            runStep();
                        }, loadingSequence[currentStep].duration);
                    } else {
                        // Loading complete, show project update popup
                        setTimeout(() => {
                            setIsInitialLoading(false);
                            setShowProjectUpdatePopup(true);
                        }, 500);
                    }
                };

                runStep();
            }, []);

            const handleStartProject = () => {
                setShowProjectUpdatePopup(false);
                
                // Reset animation states
                setTypedGreeting('');
                setShowUserIcon(false);
                setShowMeetingCard(false);
                setShowTasksTitle(false);
                setVisibleTasks([]);
                setShowStartButton(false);
                
                // Go directly to chat with initial message
                setTimeout(() => {
                    setMessages([{
                        id: 1,
                        text: "üéØ Your manager mentioned you need the Q3 financial sheet from Sarah Chen for your Tesla presentation. This seems to be blocking your progress.\n\nWould you like me to draft an email to Sarah requesting this information?",
                        sender: 'assistant',
                        timestamp: new Date()
                    }]);
                }, 300);
            };

            const handleViewMeetingNotes = () => {
                setShowMeetingNotesModal(true);
            };

            const handleCloseMeetingNotes = () => {
                setShowMeetingNotesModal(false);
            };

            const handleActionResponse = (action) => {
                setShowActionPrompt(false);
                
                if (action === 'yes') {
                    handleSendEmail();
                } else {
                    const skipMessage = {
                        id: 2,
                        text: "No problem! I'll keep this task in your list for later. Is there anything else from your meeting that you'd like to work on right now?",
                        sender: 'assistant',
                        timestamp: new Date()
                    };
                    setMessages(prev => [...prev, skipMessage]);
                }
            };

            const handleSendEmail = () => {
                setEmailStep('sending');
                
                // Add message about sending
                const sendingMessage = {
                    id: messages.length + 1,
                    text: "Sending email to Sarah Chen...",
                    sender: 'assistant',
                    timestamp: new Date()
                };
                setMessages(prev => [...prev, sendingMessage]);
                
                setTimeout(() => {
                    setEmailStep('sent');
                    
                    // Mark first task as completed
                    setCompletedTasks(prev => new Set([...prev, 1]));
                    
                    const sentMessage = {
                        id: messages.length + 2,
                        text: "‚úÖ Email sent successfully! I've marked 'Request Q3 Financial Sheet' as completed. Sarah should receive it shortly and will likely respond with the financial data.",
                        sender: 'assistant',
                        timestamp: new Date()
                    };
                    setMessages(prev => [...prev, sentMessage]);
                    
                    // Wait 5 seconds then show received file
                    setTimeout(() => {
                        setEmailStep('received');
                        
                        const receivedMessage = {
                            id: messages.length + 3,
                            text: "üìß Great news! Sarah Chen just replied with the Q3 financial sheet:",
                            sender: 'assistant',
                            timestamp: new Date(),
                            hasReceivedFile: true,
                            fileData: {
                                name: 'Tesla_Q3_Financial_Sheet.xlsx',
                                sender: 'Sarah Chen',
                                size: '2.3 MB'
                            }
                        };
                        setMessages(prev => [...prev, receivedMessage]);
                        
                        // If the received file is Tesla_Q3_Financial_Sheet.xlsx, update its status after 0.2s
                        if (receivedMessage.fileData && receivedMessage.fileData.name === 'Tesla_Q3_Financial_Sheet.xlsx') {
                            setTimeout(() => {
                                setMessages(prevMsgs => prevMsgs.map(msg =>
                                    msg.fileData && msg.fileData.name === 'Tesla_Q3_Financial_Sheet.xlsx'
                                        ? { ...msg, fileStatus: 'View' }
                                        : msg
                                ));
                            }, 200);
                        }
                        
                        // After 2 seconds, show context addition and PowerPoint suggestion
                        setTimeout(() => {
                            const contextMessage = {
                                id: messages.length + 4,
                                text: "‚úÖ I've analyzed the financial data and added it to my context. Now I can help you update your Tesla presentation with the latest Q3 numbers.",
                                sender: 'assistant',
                                timestamp: new Date()
                            };
                            setMessages(prev => [...prev, contextMessage]);
                            
                            // Show PowerPoint suggestion
                            setTimeout(() => {
                                const powerpointMessage = {
                                    id: messages.length + 5,
                                    text: "I can help you update your PowerPoint presentation with the new data:",
                                    sender: 'assistant',
                                    timestamp: new Date(),
                                    hasPowerpointSuggestion: true,
                                    powerpointData: {
                                        fileName: 'Tesla_Earnings_Presentation.pptx',
                                        suggestedEdits: [
                                            'Update Q3 revenue figures on slide 3',
                                            'Refresh profit margin charts on slide 7',
                                            'Add new quarterly comparison on slide 9',
                                            'Update executive summary with key insights'
                                        ]
                                    }
                                };
                                setMessages(prev => [...prev, powerpointMessage]);
                            }, 1500);
                        }, 2000);
                    }, 5000);
                }, 2000);
            };

            const handleOpenPowerpoint = () => {
                // Mark second task as completed
                setCompletedTasks(prev => new Set([...prev, 2]));
                
                const openingMessage = {
                    id: messages.length + 1,
                    text: "üéØ Opening Tesla_Earnings_Presentation.pptx and applying the revenue updates... I've marked 'Update Revenue Projections' as completed.",
                    sender: 'assistant',
                    timestamp: new Date()
                };
                setMessages(prev => [...prev, openingMessage]);
                
                // After 3 seconds, show completion
                setTimeout(() => {
                    const completedMessage = {
                        id: messages.length + 2,
                        text: "‚úÖ PowerPoint presentation updated successfully! The latest Q3 financial data has been integrated into slides 3, 7, and 9. Your revenue projections now reflect the most current numbers from Sarah's data.",
                        sender: 'assistant',
                        timestamp: new Date()
                    };
                    setMessages(prev => [...prev, completedMessage]);
                }, 3000);
            };

            const handleToggleChat = () => {
                setShowTasks(!showTasks);
            };

            const tasks = [
                {
                    id: 1,
                    title: "Request Q3 Financial Sheet",
                    description: "Email Sarah Chen for latest Q3 financial data for Tesla presentation",
                    priority: "high"
                },
                {
                    id: 2,
                    title: "Update Revenue Projections",
                    description: "Incorporate latest earnings data and adjust revenue projections based on manager feedback",
                    priority: "high"
                },
                {
                    id: 3,
                    title: "Review Competitor Analysis",
                    description: "Compare Tesla's performance against traditional automakers and EV competitors",
                    priority: "medium"
                },
                {
                    id: 4,
                    title: "Prepare Executive Summary",
                    description: "Create 1-page summary highlighting key insights for stakeholder meeting",
                    priority: "medium"
                },
                {
                    id: 5,
                    title: "Schedule Follow-up Meeting",
                    description: "Book time with manager to review updated presentation before final delivery",
                    priority: "low"
                }
            ];

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const formatTime = (date) => {
                return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            };

            const handleSendMessage = async () => {
                if (!inputText.trim() || isLoading) return;

                const newMessage = {
                    id: messages.length + 1,
                    text: inputText,
                    sender: 'user',
                    timestamp: new Date()
                };

                setMessages(prev => [...prev, newMessage]);
                const userInput = inputText.toLowerCase().trim();
                setInputText('');
                setIsLoading(true);

                // Check if user is responding to the initial email question
                if (messages.length === 1 && (userInput === 'yes' || userInput === 'y')) {
                    // User confirmed to draft email, start the email sequence
                    setIsLoading(false);
                    setTimeout(() => {
                        const emailDraftMessage = {
                            id: messages.length + 2,
                            text: "I've drafted an email to Sarah Chen requesting the Q3 financial sheet:",
                            sender: 'assistant',
                            timestamp: new Date(),
                            hasEmailDraft: true,
                            emailData: {
                                to: 'sarah.chen@company.com',
                                subject: 'Request for Q3 Financial Sheet - Tesla Earnings Presentation',
                                body: `Hi Sarah,

I hope this email finds you well. I'm currently working on the Tesla earnings presentation for our upcoming stakeholder meeting, and I need the latest Q3 financial sheet to ensure our projections are accurate.

Could you please send me the most recent Q3 financial data when you have a moment? This will help me finalize the revenue projections section.

Thanks in advance for your help!

Best regards,
Rohit`
                            }
                        };
                        setMessages(prev => [...prev, emailDraftMessage]);
                    }, 1000);
                    return;
                }

                // Check if user said no to the initial email question
                if (messages.length === 1 && (userInput === 'no' || userInput === 'n')) {
                    setIsLoading(false);
                    setTimeout(() => {
                        const skipMessage = {
                            id: messages.length + 2,
                            text: "No problem! I'll keep this task in your list for later. Is there anything else from your meeting that you'd like to work on right now?",
                            sender: 'assistant',
                            timestamp: new Date()
                        };
                        setMessages(prev => [...prev, skipMessage]);
                    }, 1000);
                    return;
                }

                // Default responses for other messages
                setTimeout(() => {
                    const responses = [
                        "I understand. Let me help you with those presentation updates. What specific changes did your manager request?",
                        "That sounds important. Can you tell me more about what needs to be updated in the presentation?",
                        "I'm here to help! What aspects of the Tesla earnings presentation need revision?",
                        "Got it. Let's work on those updates together. What feedback did you receive about the presentation?"
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    
                    const aiResponse = {
                        id: messages.length + 2,
                        text: randomResponse,
                        sender: 'assistant',
                        timestamp: new Date()
                    };
                    
                    setMessages(prev => [...prev, aiResponse]);
                    setIsLoading(false);
                }, 1500);
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };

            const handleInputChange = (e) => {
                setInputText(e.target.value);
                // Auto-resize textarea
                e.target.style.height = 'auto';
                e.target.style.height = Math.min(e.target.scrollHeight, 120) + 'px';
            };

            // Show loading overlay
            if (isInitialLoading) {
                return (
                    <div className="tesla-chat-container">
                        <div className="tesla-chat-header">
                            <div className="tesla-chat-title">Tesla Earnings Project</div>
                            
                            {/* View Toggle */}
                            <div className="tesla-view-toggle">
                                <button 
                                    className={`tesla-toggle-btn ${currentView === 'chat' ? 'active' : ''}`}
                                    onClick={() => setCurrentView('chat')}
                                    title="Chat"
                                >
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                                    </svg>
                                </button>
                                <button 
                                    className={`tesla-toggle-btn ${currentView === 'workspace' ? 'active' : ''}`}
                                    onClick={() => setCurrentView('workspace')}
                                    title="Workspace"
                                >
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                        <polyline points="14,2 14,8 20,8"/>
                                        <line x1="16" y1="13" x2="8" y2="13"/>
                                        <line x1="16" y1="17" x2="8" y2="17"/>
                                        <polyline points="10,9 9,9 8,9"/>
                                    </svg>
                                </button>
                            </div>

                            <button className="tesla-chat-toggle" onClick={handleToggleChat}>
                                üìã
                            </button>
                        </div>
                        <div className="tesla-chat-content">
                            <div className="tesla-loading-overlay">
                                <div className="tesla-loading-content">
                                    <div className="tesla-loading-icon"></div>
                                    <div className="tesla-loading-title">AI Assistant</div>
                                    <div className="tesla-loading-text">
                                        {loadingText}
                                        <span className="tesla-loading-dots"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="tesla-chat-container">
                    <div className="tesla-chat-header">
                        <div className="tesla-chat-title">Tesla Earnings Project</div>
                        
                        {/* View Toggle */}
                        <div className="tesla-view-toggle">
                            <button 
                                className={`tesla-toggle-btn ${currentView === 'chat' ? 'active' : ''}`}
                                onClick={() => setCurrentView('chat')}
                                title="Chat"
                            >
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                                </svg>
                            </button>
                            <button 
                                className={`tesla-toggle-btn ${currentView === 'workspace' ? 'active' : ''}`}
                                onClick={() => setCurrentView('workspace')}
                                title="Workspace"
                            >
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14,2 14,8 20,8"/>
                                    <line x1="16" y1="13" x2="8" y2="13"/>
                                    <line x1="16" y1="17" x2="8" y2="17"/>
                                    <polyline points="10,9 9,9 8,9"/>
                                </svg>
                            </button>
                        </div>

                        <button className="tesla-chat-toggle" onClick={handleToggleChat}>
                            üìã
                        </button>
                    </div>
                    <div className="tesla-chat-content">
                        <div className={`tesla-chat-main ${showTasks ? 'with-tasks' : ''}`}>
                            {currentView === 'chat' ? (
                                /* Chat Interface */
                                <>
                                    {showProjectUpdatePopup && (
                                        <div className="tesla-project-update-overlay">
                                            <div className="tesla-project-update-card">
                                                <div className="tesla-project-update-header">
                                                    <div className="tesla-project-header-content">
                                                        {showUserIcon && (
                                                            <img src="cursor.png" alt="User" className="tesla-project-user-icon tesla-animate-in" />
                                                        )}
                                                        <h2 className={`tesla-project-greeting ${typedGreeting === fullGreeting ? 'typing-complete' : ''}`}>
                                                            {typedGreeting}
                                                            {typedGreeting !== fullGreeting && <span className="tesla-typing-cursor">|</span>}
                                                        </h2>
                                                    </div>
                                                </div>
                                                
                                                <div className="tesla-project-update-content">
                                                    {/* Clickable Sub-Card for Meeting Notes */}
                                                    {showMeetingCard && (
                                                        <div className="tesla-meeting-notes-card tesla-animate-in" onClick={handleViewMeetingNotes}>
                                                            <div className="tesla-meeting-notes-icon">üìÑ</div>
                                                            <div className="tesla-meeting-notes-text">
                                                                <span className="tesla-meeting-notes-title">View Meeting Notes & Full Transcript</span>
                                                                <span className="tesla-meeting-notes-arrow">‚Üí</span>
                                                            </div>
                                                        </div>
                                                    )}

                                                    {/* Waterfall To-Do Checklist */}
                                                    <div className="tesla-waterfall-checklist">
                                                        {showTasksTitle && (
                                                            <h3 className="tesla-waterfall-title tesla-animate-in">Project Tasks</h3>
                                                        )}
                                                        <div className="tesla-waterfall-flow">
                                                            {tasks.map((task, index) => (
                                                                <div 
                                                                    key={task.id} 
                                                                    className={`tesla-waterfall-item ${visibleTasks.includes(task.id) ? 'tesla-animate-in' : ''}`}
                                                                    style={{
                                                                        opacity: visibleTasks.includes(task.id) ? 1 : 0,
                                                                        transform: visibleTasks.includes(task.id) ? 'translateY(0)' : 'translateY(30px)',
                                                                        transition: 'all 0.6s ease-out'
                                                                    }}
                                                                >
                                                                    <div className="tesla-waterfall-node">
                                                                        <div className={`tesla-waterfall-circle ${completedTasks.has(task.id) ? 'completed' : ''}`}>
                                                                            {completedTasks.has(task.id) ? '‚úì' : index + 1}
                                                                        </div>
                                                                        {index < tasks.length - 1 && (
                                                                            <div className="tesla-waterfall-line"></div>
                                                                        )}
                                                                    </div>
                                                                    <div className="tesla-waterfall-content">
                                                                        <div className="tesla-waterfall-task-title">{task.title}</div>
                                                                        <div className="tesla-waterfall-task-desc">{task.description}</div>
                                                                        <div className={`tesla-waterfall-priority ${task.priority}`}>
                                                                            {task.priority.toUpperCase()}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>

                                                    {/* Start Button */}
                                                    {showStartButton && (
                                                        <div className="tesla-project-update-actions">
                                                            <button className="tesla-project-start-btn tesla-animate-in" onClick={handleStartProject}>
                                                                <span className="tesla-start-btn-text">Start</span>
                                                                <span className="tesla-start-btn-arrow">‚Üí</span>
                                                            </button>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                    
                                    {showMeetingNotesModal && (
                                        <div className="tesla-modal-overlay" onClick={handleCloseMeetingNotes}>
                                            <div className="tesla-modal-content" onClick={(e) => e.stopPropagation()}>
                                                <div className="tesla-modal-header">
                                                    <h3 className="tesla-modal-title">Meeting Notes & Full Transcript</h3>
                                                    <button className="tesla-modal-close" onClick={handleCloseMeetingNotes}>
                                                        ‚úó
                                                    </button>
                                                </div>
                                                <div className="tesla-modal-body">
                                                    <div className="tesla-meeting-summary">
                                                        <h4>Meeting Summary</h4>
                                                        <p><strong>Date:</strong> Today, 2:30 PM</p>
                                                        <p><strong>Attendees:</strong> Rohit Shetty, Manager Jeff</p>
                                                        <p><strong>Duration:</strong> 45 minutes</p>
                                                    </div>
                                                    <div className="tesla-meeting-transcript">
                                                        <h4>Key Discussion Points</h4>
                                                        <ul>
                                                            <li>Need to update Tesla Q3 financial projections</li>
                                                            <li>Revenue data requires Sarah Chen's latest spreadsheet</li>
                                                            <li>Competitor analysis section needs refinement</li>
                                                            <li>Executive summary should highlight key growth metrics</li>
                                                            <li>Deadline: End of week for stakeholder review</li>
                                                        </ul>
                                                    </div>
                                                    <div className="tesla-meeting-actions">
                                                        <h4>Action Items Identified</h4>
                                                        <ul>
                                                            <li>‚úÖ Extract action items from meeting (completed)</li>
                                                            <li>üìß Email Sarah Chen for Q3 financial sheet</li>
                                                            <li>üìä Update PowerPoint revenue projections</li>
                                                            <li>üîç Review competitor analysis data</li>
                                                            <li>üìã Prepare executive summary</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                    
                                    <div className="tesla-chat-messages">
                                        {messages.map((message) => (
                                            <div key={message.id} className={`tesla-chat-message ${message.sender}`}>
                                                <div className={`tesla-chat-bubble ${message.sender}`}>
                                                    {message.text}
                                                </div>
                                                
                                                {/* Email Draft Component */}
                                                {message.hasEmailDraft && (
                                                    <div className="tesla-email-draft-box">
                                                        <div className="tesla-email-draft-header">
                                                            <span className="tesla-email-draft-icon">üìß</span>
                                                            <span className="tesla-email-draft-title">Email Draft</span>
                                                        </div>
                                                        <div className="tesla-email-draft-content">
                                                            <div className="tesla-email-draft-field">
                                                                <strong>To:</strong> {message.emailData.to}
                                                            </div>
                                                            <div className="tesla-email-draft-field">
                                                                <strong>Subject:</strong> {message.emailData.subject}
                                                            </div>
                                                            <div className="tesla-email-draft-body">
                                                                {message.emailData.body.split('\n').map((line, index) => (
                                                                    <p key={index}>{line}</p>
                                                                ))}
                                                            </div>
                                                            <div className="tesla-email-draft-actions">
                                                                <button 
                                                                    className="tesla-email-draft-send"
                                                                    onClick={handleSendEmail}
                                                                    disabled={emailStep !== 'draft'}
                                                                >
                                                                    {emailStep === 'draft' ? 'Send Email' : 
                                                                     emailStep === 'sending' ? 'Sending...' : 
                                                                     'Email Sent ‚úì'}
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                )}
                                                
                                                {/* Received File Component */}
                                                {message.hasReceivedFile && (
                                                    <div className="tesla-file-received-box">
                                                        <div className="tesla-file-received-header">
                                                            <span className="tesla-file-received-icon">üìé</span>
                                                            <span className="tesla-file-received-title">File Received</span>
                                                        </div>
                                                        <div className="tesla-file-received-content">
                                                            <div className="tesla-file-received-info">
                                                                <div className="tesla-file-received-name">{message.fileData.name}</div>
                                                                <div className="tesla-file-received-details">
                                                                    From: {message.fileData.sender} ‚Ä¢ {message.fileData.size}
                                                                </div>
                                                            </div>
                                                            <div className="tesla-file-received-status">
                                                                {message.fileStatus || 'Processing...'}
                                                            </div>
                                                        </div>
                                                    </div>
                                                )}
                                                
                                                {/* PowerPoint Suggestion Component */}
                                                {message.hasPowerpointSuggestion && (
                                                    <div className="tesla-powerpoint-suggestion-box">
                                                        <div className="tesla-powerpoint-suggestion-header">
                                                            <span className="tesla-powerpoint-suggestion-icon">üìä</span>
                                                            <span className="tesla-powerpoint-suggestion-title">PowerPoint Suggestion</span>
                                                        </div>
                                                        <div className="tesla-powerpoint-suggestion-content">
                                                            <div className="tesla-powerpoint-suggestion-field">
                                                                <strong>Suggested Edits:</strong>
                                                            </div>
                                                            <div className="tesla-powerpoint-suggestion-body">
                                                                {message.powerpointData.suggestedEdits.map((edit, index) => (
                                                                    <p key={index}>{edit}</p>
                                                                ))}
                                                            </div>
                                                            <div className="tesla-powerpoint-suggestion-actions">
                                                                <button 
                                                                    className="tesla-powerpoint-suggestion-apply"
                                                                    onClick={handleOpenPowerpoint}
                                                                >
                                                                    Apply Suggestion
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                )}
                                                
                                                <div className="tesla-chat-timestamp">
                                                    {formatTime(message.timestamp)}
                                                </div>
                                            </div>
                                        ))}
                                        
                                        {isLoading && (
                                            <div className="tesla-chat-loading">
                                                <div className="tesla-chat-bubble assistant">
                                                    <div className="tesla-typing-indicator">
                                                        <div className="tesla-typing-dot"></div>
                                                        <div className="tesla-typing-dot"></div>
                                                        <div className="tesla-typing-dot"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                        
                                        <div ref={messagesEndRef} />
                                    </div>

                                    <div className="tesla-chat-input-container">
                                        <div className="tesla-chat-input-box">
                                            <textarea
                                                ref={inputRef}
                                                value={inputText}
                                                onChange={handleInputChange}
                                                onKeyPress={handleKeyPress}
                                                placeholder="Message about your Tesla project..."
                                                className="tesla-chat-input"
                                                rows={1}
                                            />
                                            <button
                                                onClick={handleSendMessage}
                                                disabled={!inputText.trim() || isLoading}
                                                className={`tesla-chat-send ${inputText.trim() && !isLoading ? 'active' : ''}`}
                                            >
                                                ‚Üë
                                            </button>
                                        </div>
                                    </div>
                                </>
                            ) : (
                                /* Workspace Interface */
                                <div className="tesla-workspace">
                                    <div className="tesla-workspace-header">
                                        <h1 className="tesla-notion-title">üìä Tesla Earnings Presentation</h1>
                                    </div>
                                    
                                    <div className="tesla-notion-content">
                                        {/* Transcript & Notes Section */}
                                        <div className="tesla-notion-section">
                                            <h2 className="tesla-notion-heading">üìù Meeting Notes & Transcript</h2>
                                            <div className="tesla-notion-text">
                                                <p><strong>Meeting with Manager Jeff</strong> - Today, 2:30 PM (45 minutes)</p>
                                                <p>Key discussion points from the meeting:</p>
                                                <ul>
                                                    <li>Need to update Tesla Q3 financial projections with latest data</li>
                                                    <li>Revenue data requires Sarah Chen's latest spreadsheet</li>
                                                    <li>Competitor analysis section needs refinement</li>
                                                    <li>Executive summary should highlight key growth metrics</li>
                                                    <li><strong>Deadline:</strong> End of week for stakeholder review</li>
                                                </ul>
                                                
                                                <div className="tesla-notion-callout">
                                                    üéØ <strong>Primary Action:</strong> Get Q3 financial sheet from Sarah Chen to update revenue projections
                                                </div>
                                            </div>
                                        </div>

                                        {/* Presentation Section */}
                                        <div className="tesla-notion-section">
                                            <h2 className="tesla-notion-heading">üìä Presentation</h2>
                                            <div className="tesla-notion-file-link" onClick={() => window.open('#', '_blank')}>
                                                <div className="tesla-notion-file-icon powerpoint">üìä</div>
                                                <div className="tesla-notion-file-info">
                                                    <div className="tesla-notion-file-name">Tesla_Earnings_Presentation.pptx</div>
                                                    <div className="tesla-notion-file-meta">Updated 2 minutes ago ‚Ä¢ 3.2 MB</div>
                                                </div>
                                                <div className="tesla-notion-file-action">Open ‚Üí</div>
                                            </div>
                                        </div>

                                        {/* Documents Section */}
                                        <div className="tesla-notion-section">
                                            <h2 className="tesla-notion-heading">üìÑ Documents</h2>
                                            <div className="tesla-notion-file-link">
                                                <div className="tesla-notion-file-icon excel">üìà</div>
                                                <div className="tesla-notion-file-info">
                                                    <div className="tesla-notion-file-name">Tesla_Q3_Financial_Sheet.xlsx</div>
                                                    <div className="tesla-notion-file-meta">From Sarah Chen ‚Ä¢ Received 15 min ago ‚Ä¢ 2.3 MB</div>
                                                </div>
                                                <div className="tesla-notion-file-status">‚úÖ</div>
                                            </div>
                                        </div>

                                        {/* Timeline Section */}
                                        <div className="tesla-notion-section">
                                            <h2 className="tesla-notion-heading">‚è∞ Timeline & Deadlines</h2>
                                            <div className="tesla-notion-table">
                                                <div className="tesla-notion-table-header">
                                                    <div className="tesla-notion-table-cell">Task</div>
                                                    <div className="tesla-notion-table-cell">Status</div>
                                                    <div className="tesla-notion-table-cell">Deadline</div>
                                                </div>
                                                <div className="tesla-notion-table-row">
                                                    <div className="tesla-notion-table-cell">Request Q3 Financial Sheet</div>
                                                    <div className="tesla-notion-table-cell">
                                                        <span className="tesla-notion-status done">‚úÖ Complete</span>
                                                    </div>
                                                    <div className="tesla-notion-table-cell">Today</div>
                                                </div>
                                                <div className="tesla-notion-table-row">
                                                    <div className="tesla-notion-table-cell">Update Revenue Projections</div>
                                                    <div className="tesla-notion-table-cell">
                                                        <span className="tesla-notion-status done">‚úÖ Complete</span>
                                                    </div>
                                                    <div className="tesla-notion-table-cell">Today</div>
                                                </div>
                                                <div className="tesla-notion-table-row">
                                                    <div className="tesla-notion-table-cell">Review Competitor Analysis</div>
                                                    <div className="tesla-notion-table-cell">
                                                        <span className="tesla-notion-status pending">‚è≥ In Progress</span>
                                                    </div>
                                                    <div className="tesla-notion-table-cell">Tomorrow</div>
                                                </div>
                                                <div className="tesla-notion-table-row">
                                                    <div className="tesla-notion-table-cell">Prepare Executive Summary</div>
                                                    <div className="tesla-notion-table-cell">
                                                        <span className="tesla-notion-status pending">üìù To Do</span>
                                                    </div>
                                                    <div className="tesla-notion-table-cell">Wed</div>
                                                </div>
                                                <div className="tesla-notion-table-row">
                                                    <div className="tesla-notion-table-cell">Final Review with Manager</div>
                                                    <div className="tesla-notion-table-cell">
                                                        <span className="tesla-notion-status scheduled">üìÖ Scheduled</span>
                                                    </div>
                                                    <div className="tesla-notion-table-cell">End of Week</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className={`tesla-task-panel ${showTasks ? 'open' : ''}`}>
                            <div className="tesla-task-header">
                                <div className="tesla-task-title">Project Tasks</div>
                                <div className="tesla-task-subtitle">Tesla Earnings Presentation</div>
                            </div>
                            <div className="tesla-task-list">
                                {tasks.map((task) => (
                                    <div key={task.id} className={`tesla-task-item ${completedTasks.has(task.id) ? 'completed' : ''}`}>
                                        <div className="tesla-task-checkbox">
                                            {completedTasks.has(task.id) ? '‚úì' : '‚óã'}
                                        </div>
                                        <div className="tesla-task-content">
                                            <div className="tesla-task-item-title">{task.title}</div>
                                            <div className="tesla-task-item-desc">{task.description}</div>
                                            <div className={`tesla-task-item-priority ${task.priority}`}>
                                                {task.priority.toUpperCase()} PRIORITY
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Global variable to track if React component is mounted
        let teslaReactMounted = false;

        // Function to mount React component
        function mountTeslaChat() {
            if (!teslaReactMounted) {
                const container = document.getElementById('tesla-react-container');
                if (container) {
                    ReactDOM.render(<TeslaChat />, container);
                    teslaReactMounted = true;
                }
            }
        }

        // Function to unmount React component
        function unmountTeslaChat() {
            if (teslaReactMounted) {
                const container = document.getElementById('tesla-react-container');
                if (container) {
                    ReactDOM.unmountComponentAtNode(container);
                    teslaReactMounted = false;
                }
            }
        }
    </script>

    <!-- Existing JavaScript (keep all existing functionality) -->
    <script>
        // Home tab click
        document.getElementById('home-tab').addEventListener('click', function() {
            document.querySelectorAll('.nav-item, .project-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
            document.getElementById('main-content-home').style.display = '';
            document.getElementById('main-content-tools').style.display = 'none';
            document.getElementById('main-content-tesla').style.display = 'none';
            unmountTeslaChat();
        });

        // Tools tab click
        document.getElementById('tools-tab').addEventListener('click', function() {
            document.querySelectorAll('.nav-item, .project-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
            document.getElementById('main-content-home').style.display = 'none';
            document.getElementById('main-content-tools').style.display = '';
            document.getElementById('main-content-tesla').style.display = 'none';
            unmountTeslaChat();
        });

        // Project click - Updated to use React
        document.querySelectorAll('.project-item').forEach(item => {
            item.addEventListener('click', function() {
                document.querySelectorAll('.nav-item, .project-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                document.getElementById('main-content-home').style.display = 'none';
                document.getElementById('main-content-tools').style.display = 'none';
                document.getElementById('main-content-tesla').style.display = '';
                
                // Mount React component with a small delay
                setTimeout(() => {
                    mountTeslaChat();
                }, 100);
            });
        });

        // Keep all existing functionality for other parts
        document.querySelectorAll('.connect-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                if (!btn.classList.contains('connected')) {
                    btn.classList.add('connected');
                    btn.textContent = 'Connected';
                } else {
                    btn.classList.remove('connected');
                    btn.textContent = 'Connect';
                }
            });
        });
    </script>
</body>
</html> 